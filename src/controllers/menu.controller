import { getMenusRoute } from '../config/routes';
import { doContentPortalRequest } from "../lib/request";
import { formatMenus } from '../lib/menus/index';
import { storeContentToDB } from "../lib/store";

export class MenuController {

  constructor() {

  }

  async getMenu(options: any) {
    const { menu, save, lang = 'en' } = options;
    if (!menu) {
      throw new Error("Menu name is empty");
    }

    try {
      const menuRoute = getMenusRoute(menu, options);
      const response = await doContentPortalRequest(menuRoute, { json: true });
      const menus = formatMenus(response.body, { menu, lang });

      if (save) {
        storeContentToDB(menus)
      }

      return menus;
    } catch (err) {
      throw err;
    }
  }
}
